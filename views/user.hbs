<!--
@Author: Vargas Hector <vargash1>
@Date:   Wednesday, March 30th 2016, 5:42:52 pm
@Email:  vargash1@wit.edu
@Last modified by:   vargash1
@Last modified time: Thursday, March 31st 2016, 3:48:23 am
-->
{{#unless user.username}}
    <div class = "divform">
        Welcome to vTask, please sign in or create an account!
    </div>
{{/unless}}
{{#if message}}
    <div class = "divform">
        {{message}}
    </div>
{{/if}}
<br>
{{#if tasks}}
    <div class="grid" data-masonry='{ "columnWidth": 200, "gutter":10,"isFitWidth": true,"itemSelector": ".grid-item"}'>
    {{#each tasks}}
        <div class="grid-item">
            <blockquote class="note notecolor">
                    <div class="titletext">
                        {{title}}
                        <div class="noteoptions">
                            <a href="#" data-toggle="modal" data-target="#myModalMod" class="open-TaskMod" data-id="{{title}}" data-body="{{taskbody}}"><i class="fa fa-wrench fa-fw"></i></a>
                            <a href="#" data-toggle="modal" data-target="#myModalDel" class="open-TaskDel"><i class="fa fa-times fa-fw"></i></a>
                        </div>
                    </div>
                    <br>
                    {{taskbody}} <br>
                    <i class="fa fa-clock-o"></i> {{datedue}} {{timedue}} <br>
            </blockquote>
        </div>
    {{/each}}
    </div>
{{/if}}

<!-- Modify Modal -->
<div class="modal fade" id="myModalMod" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Modify Task</h4>
      </div>
        <div class="modal-body">
            <div class="divform">
                <form class = "centerform" method="post" action="modifytask">
                    <input type="hidden" name="oldtasktitle" id="taskID" value=""/>
                    <input type="text" name="newtasktitle" id="newtaskID" value=""/> <br>
                    Date Due<br>
                    <input type="date" name="datedue"><br>
                    Time Due<br>
                    <input type="time" name="timedue"><br><br>
                    <textarea name="taskbody" rows="10" cols="40" id="bodyID" wrap="hard">
                    </textarea><br>
                    <button type="submit" class="button">
                        <i class="fa fa-floppy-o fa-fw"></i> Modify Task
                    </button>
                </form>
            </div>
        </div>
      <div class="modal-footer">
        <button type="button" class="button" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<!-- Delete Modal -->
<div class="modal fade" id="myModalDel" tabindex="-1" role="dialog" aria-labelledby="myModalLabelDel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabelDel">Delete Task</h4>
      </div>
        <div class="modal-body">
            This cannot be undone.<br>
            <button type="submit" class="button">
                <i class="fa fa-floppy-o fa-fw"></i> Delete Task
            </button>
        </div>
      <div class="modal-footer">
        <button type="button" class="button" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
<!--  Easiest way to do this now unfortunately-->
<script>
    $(document).on("click", ".open-TaskMod", function () {
        var mytaskid = $(this).data('id');
        var mytaskbody = $(this).data('body');
        $(".modal-body #newtaskID").val( mytaskid );
        $(".modal-body #taskID").val( mytaskid );
        $(".modal-body #bodyID").val( mytaskbody );
    });
</script>
